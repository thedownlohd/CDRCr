---
title: "HW09"
author: "Kendall Loh"
date: "11/28/2018"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## Setting up Libraries
```{r}
library(rvest)
library(magrittr)
library(dplyr)
library(plyr)
library(stringr)
library(tidyr)

```


## Question 1. Get the content of the page into R.


```{r}
url <- "https://en.wikipedia.org/wiki/Mitch_McConnell"
wiki <- read_html(url)
wiki

```


## Question 2. Get the info box
```{r}
wiki_table <- html_node (x = wiki,
                         css = "table.infobox.vcard")


```

## Question 3a. Make a data frame
### Parse the dataframe.

```{r}
table <- html_table(wiki_table)
View(table)

```

### Question 3b. Name the columns of the table you obtain key and value.

```{r}

table2 <- colnames(table)[2]
table2 <- c('Full Name', table2)
View(table2)
colnames(table) <- c("Key", "Value")


df <- as_data_frame(table)
df <- rbind(table2,df)

View(df)
###

```

### Question 3c. Filter the data frame (and rename variables if necessary) to the "Full name", "Political Party", and "Children". Use this selection of variables for all subsequent questions.

```{r}
filtered <- df %>% 
  filter(Key == "Full Name" | Key == "Political party" | Key == "Children") 

View(filtered)

```

## Question 4. Make a Function
### Use the code above to make a function called get_wiki_info that uses a single input url (a Wikipedia URL) and outputs the data frame of the format above. There is no need to account for exceptions (e.g. no info box on the page; page does not exist etc.) - we will only use members of the U.S. Senate for this exercise.

```{r}

get_wiki_info <- function(url){
wiki <- read_html(url)
wiki_table <- html_node(wiki, css = "table.infobox.vcard")
table <- html_table(wiki_table)

##
table2 <- colnames(table)[2]
table2 <- c('Full Name', table2)
names(table) <- c("Key", "Value")

##
df <- as_data_frame(table)
df <- rbind(table2, df)

##
  if(sum(df$Key == "Children") == 1) {
    filtered <- df %>%
    filter(Key == "Full Name" | Key == "Political party" | Key == "Children")
    }
    else {
    x <- c('Children', 'NA')
    df <- rbind(df, x)

    filtered <- df %>%
    filter(Key == "Full Name" | Key == "Political party" | Key == "Children")
    }
  print(filtered)  
}
print(get_wiki_info("https://en.wikipedia.org/wiki/Tammy_Duckworth"))

print(get_wiki_info("https://en.wikipedia.org/wiki/Susan_Collins"))

```







